---
# Copyright 2024 Cisco Systems Inc.
# All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License"); you may
# not use this file except in compliance with the License. You may obtain
# a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
# License for the specific language governing permissions and limitations
# under the License.


# All variables intended for modification should be placed in this file.
# All variables within this role should have a prefix of "edpm_opflex"

# service name this role manages
edpm_cisco_opflex_service_name: ciscoaci_opflex_agent

# seconds between retries for download tasks
edpm_cisco_opflex_images_download_delay: 5

# number of retries for download tasks
edpm_cisco_opflex_images_download_retries: 5

edpm_cisco_opflex_image: ""

edpm_cisco_opflex_agent_config_src: "/var/lib/openstack/configs/{{ edpm_cisco_opflex_service_name }}"
edpm_cisco_opflex_agent_conf_dir: "/etc/opflex-agent-ovs"
edpm_cisco_opflex_agent_config_dir: "/var/lib/config-data/ansible-generated/opflex"
edpm_cisco_opflex_lib_dir: "/var/lib/opflex"

edpm_cisco_opflex_agent_neutron_dir: "/var/lib/config-data/ansible-generated/neutron"

edpm_cisco_opflex_common_volumes:    
    - "/etc/hosts:/etc/hosts:ro"
    - "/etc/localtime:/etc/localtime:ro"
    - "/etc/pki/ca-trust/extracted:/etc/pki/ca-trust/extracted:ro"
    - "/etc/pki/ca-trust/source/anchors:/etc/pki/ca-trust/source/anchors:ro"
    - "/etc/pki/tls/certs/ca-bundle.crt:/etc/pki/tls/certs/ca-bundle.crt:ro"
    - "/etc/pki/tls/certs/ca-bundle.trust.crt:/etc/pki/tls/certs/ca-bundle.trust.crt:ro"
    - "/etc/pki/tls/cert.pem:/etc/pki/tls/cert.pem:ro"
    - "/dev/log:/dev/log"
    - "/etc/puppet:/etc/puppet:ro"
    - "/var/lib/kolla/config_files/{{ edpm_cisco_opflex_service_name }}.json:/var/lib/kolla/config_files/config.json:ro"
    - "/run/openvswitch:/run/openvswitch:shared,z"
    - "/etc/opflex-agent-ovs/opflex_supervisord.conf:/etc/opflex-agent-ovs/opflex_supervisord.conf:ro"
    - "{{ edpm_cisco_opflex_agent_config_dir }}:/var/lib/kolla/config_files/src:ro"
    - "{{ edpm_cisco_opflex_agent_neutron_dir }}/etc/neutron/neutron.conf:/etc/neutron/neutron.conf:ro"
    - "{{ edpm_cisco_opflex_agent_neutron_dir }}/etc/neutron/metadata_agent.ini:/etc/neutron/metadata_agent.ini:ro"
    - "/var/log/containers/opflex:/var/log/opflex"
    - "/var/log/containers/neutron:/var/log/neutron"
    - "/var/run/openvswitch/:/var/run/openvswitch/:shared,z"
    - "/run/netns:/run/netns:shared"
    - "/lib/modules:/lib/modules:ro"
    - "/var/lib/opflex/files:/var/lib/opflex-agent-ovs:shared,z"
    - "/var/lib/opflex/sockets:/run/opflex:shared,z"
edpm_cisco_opflex_tls_cacert_volumes: []

# rootwrap.conf
edpm_cisco_opflex_agent_rootwrap_DEFAULT_filters_path: '/usr/share/neutron/rootwrap'
edpm_cisco_opflex_agent_rootwrap_DEFAULT_exec_dirs: '/sbin,/usr/sbin,/bin,/usr/bin,/usr/local/bin,/usr/local/sbin,/etc/neutron/kill_scripts'
edpm_cisco_opflex_agent_rootwrap_DEFAULT_use_syslog: 'False'
edpm_cisco_opflex_agent_rootwrap_DEFAULT_syslog_log_facility: 'syslog'
edpm_cisco_opflex_agent_rootwrap_DEFAULT_syslog_log_level: 'ERROR'
edpm_cisco_opflex_agent_rootwrap_DEFAULT_daemon_timeout: '600'
edpm_cisco_opflex_agent_rootwrap_DEFAULT_rlimit_nofile: '1024'

# neutron-ovn-opflex-agent.conf
edpm_cisco_opflex_agent_DEFAULT_debug: 'True'
edpm_cisco_opflex_agent_DEFAULT_metadata_workers: '1'
edpm_cisco_opflex_agent_DEFAULT_state_path: '/var/lib/neutron'
edpm_cisco_opflex_agent_agent_root_helper: 'sudo neutron-rootwrap /etc/neutron/rootwrap.conf'
edpm_cisco_opflex_agent_ovs_ovsdb_connection: 'tcp:127.0.0.1:6640'
edpm_cisco_opflex_agent_ovs_ovsdb_connection_timeout: '180'
edpm_cisco_opflex_agent_ovn_ovsdb_probe_interval: '60000'

# opflex-agent-ovs.conf
edpm_cisco_opflex_agent_encap_iface: 'br-fab_vxlan0'
edpm_cisco_opflex_agent_remote_port: 8472

# General Parameters
edpm_cisco_opflex_agent_aci_opflex_uplink_interface: ""
edpm_cisco_opflex_agent_aci_apic_infravlan: ""
edpm_cisco_opflex_agent_aci_apic_systemid: 'aci_openstack'
edpm_cisco_opflex_agent_aci_opflex_encap_mode: 'vxlan'
edpm_cisco_opflex_agent_aci_apic_infra_subnet_gateway: '10.0.0.30'
edpm_cisco_opflex_agent_aci_apic_infra_anycast_address: '10.0.0.32'

edpm_cisco_opflex_agent_neutron_external_bridge: 'br-ex'

edpm_cisco_opflex_agent_opflex_interface_type: linux
edpm_cisco_opflex_agent_opflex_enable_bond_watch: false
edpm_cisco_opflex_agent_opflex_target_bridge_to_patch: 'br-ex'
edpm_cisco_opflex_agent_opflex_interface_mtu: 1600
edpm_cisco_opflex_agent_opflex_log_level: debug2
edpm_cisco_opflex_agent_opflex_enable_drop_log: false
edpm_cisco_opflex_agent_opflex_droplog_config: {"drop-log-enable" : true}
edpm_cisco_opflex_agent_opflex_droplog_file: ""
edpm_cisco_opflex_agent_opflex_retry_delay: 10

edpm_cisco_opflex_agent_opflex_peer_port: 8009
edpm_cisco_opflex_agent_opflex_ssl_mode: 'encrypted'
edpm_cisco_opflex_agent_opflex_inspect_socket: '/var/run/opflex/opflex-agent-inspect.sock'
edpm_cisco_opflex_agent_opflex_notification_socket: '/var/run/opflex/opflex-agent-notif.sock'
edpm_cisco_opflex_agent_opflex_startup_policy_enabled: true
edpm_cisco_opflex_agent_opflex_startup_policy_file: '/var/lib/opflex-agent-ovs/policy/pol.json'
edpm_cisco_opflex_agent_opflex_startup_policy_duration: 60
edpm_cisco_opflex_agent_opflex_startup_policy_after_connect: false
edpm_cisco_opflex_agent_opflex_statistics_mode: 'real'
edpm_cisco_opflex_agent_opflex_statistics_interface_enabled: true
edpm_cisco_opflex_agent_opflex_statistics_interface_interval: 30000
edpm_cisco_opflex_agent_opflex_statistics_contract_enabled: true
edpm_cisco_opflex_agent_opflex_statistics_contract_interval: 10000
edpm_cisco_opflex_agent_opflex_statistics_security_group_enabled: true
edpm_cisco_opflex_agent_opflex_statistics_security_group_interval: 10000
edpm_cisco_opflex_agent_opflex_statistics_service_flow_disabled: false
edpm_cisco_opflex_agent_opflex_statistics_service_enabled: true
edpm_cisco_opflex_agent_opflex_statistics_service_interval: 10000
edpm_cisco_opflex_agent_opflex_statistics_table_drop_enabled: true
edpm_cisco_opflex_agent_opflex_statistics_table_drop_interval: 30000
edpm_cisco_opflex_agent_opflex_statistics_system_enabled: true
edpm_cisco_opflex_agent_opflex_statistics_system_interval: 10000
edpm_cisco_opflex_agent_opflex_statistics_nat_enabled: false
edpm_cisco_opflex_agent_opflex_statistics_nat_interval: 10000
edpm_cisco_opflex_agent_opflex_opflex_async_parser: false
edpm_cisco_opflex_agent_opflex_ovsdb_async_parser: false
edpm_cisco_opflex_agent_opflex_disabled_features: []
edpm_cisco_opflex_agent_opflex_endpoint_dir: '/var/lib/opflex-agent-ovs/endpoints'
edpm_cisco_opflex_agent_aci_opflex_ovs_bridge: 'br-fabric'
edpm_cisco_opflex_agent_opflex_virtual_router: true
edpm_cisco_opflex_agent_opflex_virtual_router_mac: '00:22:bd:f8:19:ff'
edpm_cisco_opflex_agent_opflex_router_advertisement: false
edpm_cisco_opflex_agent_opflex_virtual_dhcp_enabled: true
edpm_cisco_opflex_agent_opflex_virtual_dhcp_mac: '00:22:bd:f8:19:ff'
edpm_cisco_opflex_agent_opflex_cache_dir: '/var/lib/opflex-agent-ovs/ids'